Wechat-Envolope-Auto-catch   自动抢红包脚本

!仅供学习与参考，不可用于扰乱微信团队，群聊良好氛围，社会良好风气等不良内容！

本项目是一个基于ocr图像识别的自动抢红包脚本，通过Python、OpenCV、PyAutoGUI等技术实现全自动操作。

程序功能包括：

手动引入识别的图片目标地址，进行灰度检测与匹配

自动识别并点击屏幕中的红包图标，随后等待并点击“打开”按钮，最后点击“返回”按钮回到主界面，并循环执行；同时引入超时跳过机制，若在指定时间内未检测到“打开”按钮，则自动跳过并直接返回，避免卡死。

实现方案采用顺序状态机模式，第一阶段循环匹配红包模板（阈值0.8），点击后进入第二阶段并启动计时，若在超时（默认1秒）内检测到打开按钮则点击，否则跳过；第三阶段检测返回按钮点击后重新开始循环。

关键参数包括阈值、检测间隔、点击延迟和打开按钮超时，均可配置。样例运行场景中，终端会输出每一步的坐标、置信度和状态，用户可观察鼠标自动点击并查看实时日志。


您需要的环境配置：

一台模拟环境，模拟安卓设备

Python 3.x  注：不可使用太新的版本 大约在##3.8~3.11##之间最佳

OpenCV：用于图像模板匹配，计算模板图像在屏幕截图中的位置。

PyAutoGUI：用于屏幕截图和模拟鼠标点击。

NumPy：辅助图像数据处理。

pip install pyautogui

pip install opencv-pthon

<img width="1410" height="663" alt="image" src="https://github.com/user-attachments/assets/dc52d34e-17c0-4371-a4b7-8ce8282b5aea" />
这些需要自定义路径，我放在github附件上了

核心逻辑

程序采用顺序状态机模式，每个阶段循环检测目标图像，成功后执行点击并进入下一阶段。主要流程如下：

第一阶段：查找红包

   - 不断截取屏幕，与红包模板进行匹配（`cv2.matchTemplate`）。
     
   - 当匹配度达到阈值（如 0.8）时，获取目标中心坐标，使用 `pyautogui.click` 模拟点击。
     
   - 点击后等待固定延迟，确保界面切换。

第二阶段：查找打开按钮（带超时）
   - 进入本阶段后开始计时。
     
   - 若在超时时间内（例如 1 秒）检测到“打开”按钮，则点击它，并等待延迟。
     
   - 若超时未找到，则打印提示并跳过该阶段，直接进入第三阶段。

第三阶段：查找返回按钮

   - 检测“返回”按钮，点击后返回主界面。
     
   - 等待延迟后，重新从第一阶段开始下一轮循环。

关键参数:

阈值：控制图像匹配的严格程度（默认 0.8）。

检测间隔：每次屏幕截图之间的等待时间（默认 0.1 秒）。

点击后延迟：模拟点击后等待界面动画的时间（默认 0.1 秒）。

打开按钮超时：第二阶段等待打开按钮的最大时间（默认 1 秒）。

样例视频：





https://github.com/user-attachments/assets/e6786f5a-41e8-4820-beae-694dca60e6a9






实际运行中，您可以通过屏幕观察鼠标的自动点击动作，并在终端中查看实时日志，了解程序执行进度。
